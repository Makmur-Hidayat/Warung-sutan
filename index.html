<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WARUNG SUTAN</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
  <style>
    .fade-enter-active, .fade-leave-active {
      transition: opacity 0.5s ease;
    }
    .fade-enter, .fade-leave-to {
      opacity: 0;
    }
    .blink {
      animation: blink 1s infinite;
      color: #ff7043;
    }
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
  </style>
</head>
<body>
<div id="app" class="p-4 max-w-4xl mx-auto relative">
  <!-- Tulisan Berkedip Freezee WARUNG LAINNYA -->
  <div class="text-center mb-4">
    <a href="https://sifood.online" target="_blank" class="blink text-lg font-bold">LIHAT WARUNG LAINNYA</a>
  </div>

  <!-- Notifikasi -->
  <transition name="fade">
    <div v-if="notif.message" :class="['fixed top-4 left-1/2 transform -translate-x-1/2 z-50 px-4 py-2 rounded shadow text-white', notif.type === 'error' ? 'bg-red-500' : 'bg-green-500']">
      {{ notif.message }}
    </div>
  </transition>

  <!-- Overlay jika toko tutup -->
  <div v-if="!isOpen" class="absolute inset-0 bg-gray-900 bg-opacity-80 flex items-center justify-center z-50">
    <div class="text-center">
      <h1 class="text-white text-4xl font-bold mb-2">Toko sedang tutup</h1>
      <p class="text-white">Jam operasional: 00:01 - 21:00</p>
<p class="text-white">Hari buka: Senin - minggu</p>
    </div>
  </div>

  <!-- Judul -->
  <h1 class="text-2xl font-bold mb-4">WARUNG SUTAN <span class="ml-2 text-green-600" v-if="isOpen">BUKA JAM 11:00-21:00</span></h1>

  <!-- Makanan -->
  <h2 class="text-xl font-semibold mb-2">Makanan</h2>
  <div class="grid grid-cols-2 gap-4 mb-4">
    <div v-for="item in makanan" :key="item.nama" class="border rounded-lg p-2 shadow">
      <img :src="item.gambar" alt="menu" class="w-full h-32 object-cover rounded" />
      <h3 class="font-bold">{{ item.nama }}</h3>
      <p class="text-sm text-gray-600">Rp{{ item.harga }}</p>
      <label class="block mt-1 text-sm">Topping <span class="text-red-500">*</span>:</label>
      <select v-model="item.toppingDipilih" multiple class="w-full border rounded p-1 text-sm">
        <option v-for="top in item.topping" :value="top">{{ top.nama }} - Rp{{ top.harga }}</option>
      </select>
      <div class="flex justify-between items-center mt-2">
        <div class="flex items-center space-x-2">
          <button @click="kurangQty(item)" class="px-2 bg-gray-200">-</button>
          <span>{{ item.qty }}</span>
          <button @click="tambahQty(item)" class="px-2 bg-gray-200">+</button>
        </div>
        <span class="text-sm font-bold">Rp{{ getHargaItem(item).toLocaleString() }}</span>
      </div>
      <label class="block text-sm mt-1">Catatan (opsional):</label>
      <textarea v-model="item.catatan" rows="2" class="w-full border rounded p-1 text-sm" placeholder="Tanpa sambal, pedas, dll"></textarea>
      <button @click="masukkanKeranjang(item)" class="mt-2 bg-green-500 text-white px-2 py-1 rounded text-sm w-full">Masukkan ke Keranjang</button>
      <p v-if="item.error" class="text-red-500 text-xs mt-1">{{ item.error }}</p>
    </div>
  </div>

  <!-- Minuman -->
  <h2 class="text-xl font-semibold mb-2">Minuman</h2>
  <div class="grid grid-cols-2 gap-4 mb-4">
    <div v-for="item in minuman" :key="item.nama" class="border rounded-lg p-2 shadow">
      <img :src="item.gambar" alt="menu" class="w-full h-32 object-cover rounded" />
      <h3 class="font-bold">{{ item.nama }}</h3>
      <p class="text-sm text-gray-600">Rp{{ item.harga }}</p>
      <label class="block text-sm mt-1">Opsi <span class="text-red-500">*</span>:</label>
      <select v-model="item.opsiDipilih" class="w-full border rounded p-1 text-sm">
        <option disabled value="">Pilih Opsi</option>
        <option v-for="opsi in item.opsi" :value="opsi">{{ opsi }}</option>
      </select>
      <div class="flex justify-between items-center mt-2">
        <div class="flex items-center space-x-2">
          <button @click="kurangQty(item)" class="px-2 bg-gray-200">-</button>
          <span>{{ item.qty }}</span>
          <button @click="tambahQty(item)" class="px-2 bg-gray-200">+</button>
        </div>
        <span class="text-sm font-bold">Rp{{ (item.harga * item.qty).toLocaleString() }}</span>
      </div>
      <label class="block text-sm mt-1">Catatan (opsional):</label>
      <textarea v-model="item.catatan" rows="2" class="w-full border rounded p-1 text-sm" placeholder="Tanpa es, kurang manis, dll"></textarea>
      <button @click="masukkanKeranjang(item)" class="mt-2 bg-green-500 text-white px-2 py-1 rounded text-sm w-full">Masukkan ke Keranjang</button>
      <p v-if="item.error" class="text-red-500 text-xs mt-1">{{ item.error }}</p>
    </div>
  </div>

 <!-- Keranjang -->
  <div class="mt-4">
    <h2 class="text-xl font-semibold mb-2">Keranjang</h2>
    <ul>
      <li v-for="(item, index) in keranjang" :key="index" class="border-b py-2">
        <p class="font-bold">{{ item.nama }} x{{ item.qty }}</p>

        <p v-if="item.topping.length">Topping: {{ item.topping.map(t => t.nama).join(', ') }}</p>
        <p v-if="item.opsi">Opsi: {{ item.opsi }}</p>
<p class="text-sm text-gray-700">Subtotal: Rp{{ getHargaItem(item).toLocaleString() }}</p>
        <p v-if="item.catatan">Catatan: {{ item.catatan }}</p>
        <button @click="hapusItem(index)" class="text-red-500 text-sm mt-1">Hapus</button>
      </li>
    </ul>
    <p class="mt-2 font-semibold">Total: Rp{{ totalPesanan.toLocaleString() }}</p>
    <label class="block mt-2">Lokasi Antar <span class="text-red-500">*</span>:</label>
    <select v-model="lokasiDipilih" class="border p-1 rounded w-full">
      <option disabled value="">Pilih Lokasi</option>
      <option v-for="lok in lokasiAntar" :value="lok">{{ lok.nama }} - Rp{{ lok.ongkir }}</option>
    </select>
    <label class="block mt-2">Alamat Lengkap <span class="text-red-500">*</span>:</label>
    <textarea v-model="alamatLengkap" class="border rounded w-full p-2" rows="2" placeholder="Contoh: Gg Mawar No 17, pagar hijau, atas nama Budi"></textarea>
    <p class="mt-2 font-bold">Total + Ongkir: Rp{{ (totalPesanan + (lokasiDipilih ? lokasiDipilih.ongkir : 0)).toLocaleString() }}</p>
    <button :disabled="!bisaCheckout" @click="checkout" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded disabled:opacity-50 w-full">
      Kirim ke WhatsApp Admin
    </button>
  </div>
</div>
<script>
new Vue({
  el: '#app',
  data: {
    makanan: [],
    minuman: [],
    keranjang: [],
    lokasiAntar: [
      { nama: 'KM 0', ongkir: 13000 }, { nama: 'KM 2', ongkir: 11000 },
      { nama: 'KM 3', ongkir: 10000 }, { nama: 'KM 4', ongkir: 9000 },
      { nama: 'Mapaddegat bagian Bawah dst', ongkir: 10000 }, { nama: 'KM 5', ongkir: 8000 },
      { nama: 'KM 6', ongkir: 7000 }, { nama: 'KM 7', ongkir: 6000 },
      { nama: 'KM 8', ongkir: 5000 }, { nama: 'KM 9', ongkir: 5000 },
      { nama: 'KM 10', ongkir: 6000 }, { nama: 'SP2 Blok M dst ', ongkir: 7000 }
    ],
    lokasiDipilih: null,
    alamatLengkap: '',
    isOpen: false,
    notif: { message: '', type: '' }
  },
  computed: {
    totalPesanan() {
      return this.keranjang.reduce((acc, item) => {
        const toppingTotal = item.topping.reduce((sum, t) => sum + t.harga, 0);
        return acc + (item.harga + toppingTotal) * item.qty;
      }, 0);
    },
    bisaCheckout() {
      return this.keranjang.length > 0 && this.lokasiDipilih && this.alamatLengkap.trim() !== '';
    }
  },
  created() {
    const jam = new Date().getHours();
    this.isOpen = jam >= 0 && jam < 21;

    const gambarMakanan = [
      'https://i.ibb.co.com/KccY6t5Y/Properti-Sifood-20250507-215020-0000.jpg',
      'https://linkgambar.com/mie2.jpg',
      'https://linkgambar.com/mie3.jpg',
      'https://i.ibb.co.com/KccY6t5Y/Properti-Sifood-20250507-215020-0000.jpg'
    ];
    const topping = [
      { nama: 'Telur Matasapi', harga: 4000 },
      { nama: 'Telur Dadar', harga: 4000 },
      { nama: 'Sosis', harga: 4000 },
      { nama: 'Bakso', harga: 4000 }
    ];
    const opsi = ['pakai Boba', 'Tanpa Boba'];
    this.makanan = [
      'Mie pedas dower Original',
      'Mie pedas dower level Selow',
      'Mie pedas dower level lumayan',
      'Mie pedas dower level maximal'
    ].map((nama, i) => ({
      nama,
      harga: 12000,
      gambar: gambarMakanan[i],
      topping,
      toppingDipilih: [],
      qty: 1,
      catatan: '',
      error: ''
    }));
    const gambarMinuman = [
      'https://linkgambar.com/caramel.jpg',
      'https://linkgambar.com/taro.jpg',
      'https://linkgambar.com/vanila.jpg',
      'https://linkgambar.com/vanila-latte.jpg',
      'https://i.ibb.co.com/KccY6t5Y/Properti-Sifood-20250507-215020-0000.jpg',
      'https://linkgambar.com/mangga.jpg',
      'https://linkgambar.com/lemontea.jpg'
    ];
    this.minuman = [
      'Milkshake Boba Caramel',
      'Milkshake Boba Taro',
      'Milkshake Boba vanila',
      'Milkshake Boba vanila late',
      'Milkshake Boba cappucino',
      'Milkshake Boba Mangga',
      'Lemon Tea'
    ].map((nama, i) => ({
      nama,
      harga: nama === 'Lemon Tea' ? 10000 : 13000,
      gambar: gambarMinuman[i],
      opsi: nama === 'Lemon Tea' ? ['Dingin', 'Hangat'] : opsi,
      opsiDipilih: '',
      qty: 1,
      catatan: '',
      error: ''
    }));
  },
  methods: {
    tambahQty(item) { item.qty++; },
    kurangQty(item) { if (item.qty > 1) item.qty--; },
    getHargaItem(item) {
  const topping = item.toppingDipilih || item.topping || [];
  const toppingTotal = topping.reduce((sum, t) => sum + t.harga, 0);
  return (item.harga + toppingTotal) * item.qty;
},
    showNotif(message, type = 'success') {
      this.notif = { message, type };
      setTimeout(() => { this.notif.message = ''; }, 3000);
    },
    masukkanKeranjang(item) {
      item.error = '';
      if ((item.topping && item.toppingDipilih.length === 0) || (item.opsi && !item.opsiDipilih)) {
        item.error = 'Wajib pilih topping atau opsi';
        this.showNotif(item.error, 'error');
        return;
      }
      const toppingNama = item.toppingDipilih?.map(t => t.nama).sort().join(',') || '';
      const opsi = item.opsiDipilih || '';
      const itemKey = `${item.nama}|${toppingNama}|${opsi}`;
      const sudahAda = this.keranjang.some(i => {
        const key = `${i.nama}|${i.topping.map(t => t.nama).sort().join(',')}|${i.opsi || ''}`;
        return key === itemKey;
      });
      if (sudahAda) {
        item.error = 'Menu dengan pilihan ini sudah ada di keranjang';
        this.showNotif(item.error, 'error');
        return;
      }
      this.keranjang.push({
        nama: item.nama,
        qty: item.qty,
        harga: item.harga,
        topping: item.toppingDipilih ? JSON.parse(JSON.stringify(item.toppingDipilih)) : [],
        opsi,
        catatan: item.catatan.trim()
      });
      item.qty = 1;
      if (item.topping) item.toppingDipilih = [];
      if (item.opsi) item.opsiDipilih = '';
      item.catatan = '';
      this.showNotif('Item berhasil dimasukkan ke keranjang');
    },
    hapusItem(index) {
      this.keranjang.splice(index, 1);
    },
    checkout() {
  if (!this.bisaCheckout) {
    if (this.keranjang.length === 0) {
      this.showNotif('Keranjang masih kosong!', 'error');
    } else if (!this.lokasiDipilih) {
      this.showNotif('Silakan pilih lokasi antar!', 'error');
    } else if (this.alamatLengkap.trim() === '') {
      this.showNotif('Silakan isi alamat lengkap!', 'error');
    } else {
      this.showNotif('Lengkapi semua data terlebih dahulu!', 'error');
    }
    return;
  }

  const now = new Date();
  const waktu = `${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;
  const pesan = `*Halo Admin... Proses Orderanku di WARUNG SUTAN:*%0A` +
`*Waktu: ${waktu}*%0A%0A` +
`====================%0A `+
  this.keranjang.map(i => {
    const toppingList = i.topping.length ? 'Topping: ' + i.topping.map(t => t.nama).join(', ') + '%0A' : '';
    const opsiText = i.opsi ? 'Opsi: ' + i.opsi + '%0A' : '';
    const catatanText = i.catatan ? 'Catatan: ' + i.catatan + '%0A' : '';
    const subtotal = (i.harga + i.topping.reduce((sum, t) => sum + t.harga, 0)) * i.qty;
    return `*${i.nama}* x ${i.qty} Porsi%0A${toppingList}${opsiText}${catatanText}Subtotal: Rp${subtotal.toLocaleString()}%0A`;
  }).join('%0A') +
`%0A====================%0A` +
`*Total Harga:* Rp${this.totalPesanan.toLocaleString()}%0A` +
`*Ongkir (${this.lokasiDipilih.nama}):* Rp${this.lokasiDipilih.ongkir.toLocaleString()}%0A` +
`*Total Bayar:* Rp${(this.totalPesanan + this.lokasiDipilih.ongkir).toLocaleString()}%0A` +
`*Alamat:* ${this.alamatLengkap}%0A%0A`+
`Terima Kasih telah Belanja di *sifood.online* Hapenya Mohon Stanby yah`;

  const nomorAdmin = '6285266610522';
  const url = `https://wa.me/${nomorAdmin}?text=${pesan}`;
  window.open(url, '_blank');
    }
  }
});
</script>
</body>
</html>
